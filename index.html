<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCLDI Student Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: #FFFFFF;
            color: #000000;
            overflow-x: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 240px;
            background: #FFFFFF;
            border-right: 1px solid #E0E0E0;
            display: flex;
            flex-direction: column;
        }

        .logo {
            padding: 24px 20px;
            font-size: 18px;
            font-weight: 700;
            border-bottom: 1px solid #E0E0E0;
        }

        .nav-menu {
            flex: 1;
            padding: 20px 0;
        }

        .nav-item {
            padding: 14px 20px;
            cursor: pointer;
            font-size: 15px;
            transition: background 0.2s;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: #F5F5F5;
        }

        .nav-item.active {
            background: #F5F5F5;
            border-left-color: #000000;
            font-weight: 600;
        }

        .main-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .top-bar {
            height: 64px;
            background: #FFFFFF;
            border-bottom: 1px solid #E0E0E0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 32px;
        }

        .center-selector {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .center-selector label {
            font-weight: 600;
            font-size: 14px;
        }

        .center-selector select {
            padding: 8px 16px;
            border: 1px solid #000000;
            background: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
            min-width: 200px;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 14px;
            font-weight: 600;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            background: #000000;
            color: #FFFFFF;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
        }

        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 32px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 24px;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .kpi-card {
            background: #FFFFFF;
            border: 1px solid #E0E0E0;
            padding: 24px;
        }

        .kpi-card.warning {
            border: 2px solid #FF0000;
            background: #FFF5F5;
        }

        .kpi-label {
            font-size: 13px;
            color: #666666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .kpi-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .kpi-subtitle {
            font-size: 12px;
            color: #999999;
        }

        .btn {
            background: #000000;
            color: #FFFFFF;
            border: none;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        .btn:hover {
            opacity: 0.85;
        }

        .btn-secondary {
            background: #FFFFFF;
            color: #000000;
            border: 1px solid #000000;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 13px;
        }

        .table-container {
            background: #FFFFFF;
            border: 1px solid #E0E0E0;
            margin-top: 20px;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid #E0E0E0;
        }

        .table-title {
            font-size: 18px;
            font-weight: 700;
        }

        .table-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .search-box {
            padding: 8px 16px;
            border: 1px solid #E0E0E0;
            font-size: 14px;
            width: 240px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #F9F9F9;
        }

        th {
            text-align: left;
            padding: 14px 24px;
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid #E0E0E0;
        }

        td {
            padding: 16px 24px;
            border-bottom: 1px solid #F0F0F0;
            font-size: 14px;
        }

        tr:hover {
            background: #FAFAFA;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 6px 12px;
            font-size: 12px;
            background: #FFFFFF;
            color: #000000;
            border: 1px solid #E0E0E0;
            cursor: pointer;
            transition: background 0.2s;
        }

        .action-btn:hover {
            background: #F5F5F5;
        }

        .action-btn.delete {
            color: #FF0000;
            border-color: #FF0000;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #FFFFFF;
            width: 90%;
            max-width: 560px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid #E0E0E0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-body {
            padding: 24px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #E0E0E0;
            font-size: 14px;
            font-family: inherit;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #000000;
        }

        .modal-footer {
            padding: 20px 24px;
            border-top: 1px solid #E0E0E0;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        .section-divider {
            margin: 32px 0;
            border: none;
            border-top: 1px solid #E0E0E0;
        }

        .center-overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
            margin-top: 24px;
        }

        .center-card {
            background: #FFFFFF;
            border: 1px solid #E0E0E0;
            padding: 16px;
        }

        .center-card.warning {
            border: 2px solid #FF0000;
        }

        .center-name {
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .center-stat {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            margin-bottom: 6px;
        }

        .center-stat-label {
            color: #666666;
        }

        .center-stat-value {
            font-weight: 600;
        }

        .center-stat-value.warning {
            color: #FF0000;
        }

        .filter-bar {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-select {
            padding: 8px 16px;
            border: 1px solid #E0E0E0;
            font-size: 14px;
            min-width: 160px;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            font-size: 11px;
            font-weight: 600;
            border-radius: 12px;
            background: #F0F0F0;
            color: #000000;
        }

        .badge.warning {
            background: #FF0000;
            color: #FFFFFF;
        }

        .badge.success {
            background: #00CC66;
            color: #FFFFFF;
        }

        .aging-report {
            margin-top: 24px;
        }

        .aging-header {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr;
            gap: 16px;
            padding: 14px 24px;
            background: #F9F9F9;
            border: 1px solid #E0E0E0;
            border-bottom: none;
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .aging-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr;
            gap: 16px;
            padding: 16px 24px;
            border: 1px solid #E0E0E0;
            border-top: none;
            font-size: 14px;
            align-items: center;
        }

        .aging-row:hover {
            background: #FAFAFA;
        }

        .aging-row.warning {
            background: #FFF5F5;
        }

        .amount {
            font-weight: 600;
            font-family: 'Courier New', monospace;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999999;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .empty-state-text {
            font-size: 16px;
        }

        .stats-row {
            display: flex;
            justify-content: space-between;
            padding: 16px 24px;
            background: #F9F9F9;
            border: 1px solid #E0E0E0;
            margin-top: 20px;
            font-weight: 600;
        }

        .two-column-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .summary-card {
            background: #F9F9F9;
            border: 1px solid #E0E0E0;
            padding: 20px;
            margin-top: 20px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            font-size: 14px;
        }

        .summary-row.total {
            border-top: 2px solid #000000;
            margin-top: 12px;
            padding-top: 12px;
            font-size: 18px;
            font-weight: 700;
        }

        .info-banner {
            background: #F0F0F0;
            border-left: 4px solid #000000;
            padding: 16px 20px;
            margin-bottom: 24px;
            font-size: 14px;
        }

        .info-banner.warning {
            background: #FFF5F5;
            border-left-color: #FF0000;
            color: #CC0000;
        }

        .settings-section {
            margin-bottom: 32px;
        }

        .settings-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border: 1px solid #E0E0E0;
            margin-bottom: 12px;
        }

        .settings-label {
            font-size: 14px;
            font-weight: 600;
        }

        .settings-description {
            font-size: 13px;
            color: #666666;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="sidebar">
            <div class="logo">CCLDI CSMS</div>
            <div class="nav-menu">
                <div class="nav-item active" data-page="dashboard">Dashboard</div>
                <div class="nav-item" data-page="students">Students</div>
                <div class="nav-item" data-page="billing">Billing</div>
                <div class="nav-item" data-page="settings">Settings</div>
            </div>
        </div>

        <div class="main-container">
            <div class="top-bar">
                <div class="center-selector">
                    <label for="centerSelect">Center:</label>
                    <select id="centerSelect">
                        <option value="all">All Centers</option>
                    </select>
                </div>
                <div class="user-profile">
                    <span>President</span>
                    <div class="user-avatar">P</div>
                </div>
            </div>

            <div class="content-area" id="contentArea"></div>
        </div>
    </div>

    <div class="modal" id="studentModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="studentModalTitle">Add Student</div>
                <button class="close-btn" onclick="closeStudentModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="studentForm">
                    <input type="hidden" id="studentId">
                    <div class="two-column-form">
                        <div class="form-group">
                            <label class="form-label">First Name</label>
                            <input type="text" class="form-input" id="studentFirstName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Last Name</label>
                            <input type="text" class="form-input" id="studentLastName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Age</label>
                            <input type="number" class="form-input" id="studentAge" min="1" max="18" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Gender</label>
                            <select class="form-select" id="studentGender" required>
                                <option value="">Select</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                            </select>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">Parent/Guardian Name</label>
                            <input type="text" class="form-input" id="studentParent" required>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">Contact Number</label>
                            <input type="tel" class="form-input" id="studentContact" required>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-input" id="studentEmail">
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">Assigned Center</label>
                            <select class="form-select" id="studentCenter" required>
                            </select>
                        </div>
                        <div class="form-group full-width">
                            <label class="form-label">Monthly Tuition (PHP)</label>
                            <input type="number" class="form-input" id="studentTuition" min="0" step="0.01" required>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeStudentModal()">Cancel</button>
                <button class="btn" onclick="saveStudent()">Save Student</button>
            </div>
        </div>
    </div>

    <div class="modal" id="billingModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Record Payment</div>
                <button class="close-btn" onclick="closeBillingModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="billingForm">
                    <div class="form-group">
                        <label class="form-label">Student</label>
                        <select class="form-select" id="billingStudent" required>
                            <option value="">Select Student</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Payment Type</label>
                        <select class="form-select" id="billingType" required>
                            <option value="tuition">Tuition</option>
                            <option value="miscellaneous">Miscellaneous Fees</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Amount (PHP)</label>
                        <input type="number" class="form-input" id="billingAmount" min="0" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Payment Date</label>
                        <input type="date" class="form-input" id="billingDate" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Notes</label>
                        <input type="text" class="form-input" id="billingNotes">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeBillingModal()">Cancel</button>
                <button class="btn" onclick="recordPayment()">Record Payment</button>
            </div>
        </div>
    </div>

    <script>
        const CCLDI_DATABASE = {
            centers: [
                { id: 'alabang', name: 'Alabang Corporate Center', type: 'corporate', capacity: 120 },
                { id: 'makati-legaspi', name: 'Makati Legaspi Corporate Center', type: 'corporate', capacity: 100 },
                { id: 'makati-salcedo', name: 'Makati Salcedo Corporate Center', type: 'corporate', capacity: 90 },
                { id: 'ortigas', name: 'Ortigas Corporate Center', type: 'corporate', capacity: 110 },
                { id: 'bgc', name: 'BGC Corporate Center', type: 'corporate', capacity: 130 },
                { id: 'qc-eastwood', name: 'QC Eastwood Corporate Center', type: 'corporate', capacity: 95 },
                { id: 'qc-vertis', name: 'QC Vertis North Corporate Center', type: 'corporate', capacity: 105 },
                { id: 'pasig', name: 'Pasig Corporate Center', type: 'corporate', capacity: 85 },
                { id: 'mandaluyong', name: 'Mandaluyong Corporate Center', type: 'corporate', capacity: 100 },
                { id: 'paranaque', name: 'Paranaque Corporate Center', type: 'corporate', capacity: 80 },
                { id: 'taguig', name: 'Taguig Corporate Center', type: 'corporate', capacity: 90 },
                { id: 'cebu', name: 'Cebu Franchise', type: 'franchise', capacity: 150 },
                { id: 'davao', name: 'Davao Franchise', type: 'franchise', capacity: 140 },
                { id: 'baguio', name: 'Baguio Franchise', type: 'franchise', capacity: 100 },
                { id: 'iloilo', name: 'Iloilo Franchise', type: 'franchise', capacity: 110 },
                { id: 'cagayan', name: 'Cagayan de Oro Franchise', type: 'franchise', capacity: 120 }
            ],
            students: [
                { id: 1, firstName: 'Maria', lastName: 'Santos', age: 5, gender: 'Female', parent: 'Juan Santos', contact: '09171234567', email: 'juan.santos@email.com', center: 'alabang', tuition: 15000, enrollmentDate: '2024-01-15', status: 'active' },
                { id: 2, firstName: 'Jose', lastName: 'Reyes', age: 4, gender: 'Male', parent: 'Ana Reyes', contact: '09182345678', email: 'ana.reyes@email.com', center: 'makati-legaspi', tuition: 16000, enrollmentDate: '2024-01-20', status: 'active' },
                { id: 3, firstName: 'Isabel', lastName: 'Cruz', age: 6, gender: 'Female', parent: 'Carlos Cruz', contact: '09193456789', email: 'carlos.cruz@email.com', center: 'bgc', tuition: 18000, enrollmentDate: '2024-02-01', status: 'active' },
                { id: 4, firstName: 'Miguel', lastName: 'Bautista', age: 3, gender: 'Male', parent: 'Rosa Bautista', contact: '09204567890', email: 'rosa.bautista@email.com', center: 'ortigas', tuition: 14000, enrollmentDate: '2024-02-05', status: 'active' },
                { id: 5, firstName: 'Sofia', lastName: 'Garcia', age: 5, gender: 'Female', parent: 'Luis Garcia', contact: '09215678901', email: 'luis.garcia@email.com', center: 'cebu', tuition: 13000, enrollmentDate: '2024-01-10', status: 'active' },
                { id: 6, firstName: 'Gabriel', lastName: 'Torres', age: 7, gender: 'Male', parent: 'Elena Torres', contact: '09226789012', email: 'elena.torres@email.com', center: 'davao', tuition: 13500, enrollmentDate: '2024-01-18', status: 'active' },
                { id: 7, firstName: 'Lucia', lastName: 'Mendoza', age: 4, gender: 'Female', parent: 'Pedro Mendoza', contact: '09237890123', email: 'pedro.mendoza@email.com', center: 'makati-salcedo', tuition: 15500, enrollmentDate: '2024-02-12', status: 'active' },
                { id: 8, firstName: 'Diego', lastName: 'Flores', age: 6, gender: 'Male', parent: 'Carmen Flores', contact: '09248901234', email: 'carmen.flores@email.com', center: 'qc-eastwood', tuition: 14500, enrollmentDate: '2024-01-25', status: 'active' },
                { id: 9, firstName: 'Angelica', lastName: 'Ramos', age: 5, gender: 'Female', parent: 'Roberto Ramos', contact: '09259012345', email: 'roberto.ramos@email.com', center: 'pasig', tuition: 14000, enrollmentDate: '2024-02-08', status: 'active' },
                { id: 10, firstName: 'Daniel', lastName: 'Valdez', age: 4, gender: 'Male', parent: 'Mariana Valdez', contact: '09260123456', email: 'mariana.valdez@email.com', center: 'baguio', tuition: 12000, enrollmentDate: '2024-01-22', status: 'active' },
                { id: 11, firstName: 'Camila', lastName: 'Aquino', age: 6, gender: 'Female', parent: 'Rodrigo Aquino', contact: '09271234567', email: 'rodrigo.aquino@email.com', center: 'alabang', tuition: 15000, enrollmentDate: '2024-02-15', status: 'active' },
                { id: 12, firstName: 'Rafael', lastName: 'Santiago', age: 5, gender: 'Male', parent: 'Isabella Santiago', contact: '09282345678', email: 'isabella.santiago@email.com', center: 'bgc', tuition: 18000, enrollmentDate: '2024-01-30', status: 'active' },
                { id: 13, firstName: 'Valentina', lastName: 'Morales', age: 3, gender: 'Female', parent: 'Francisco Morales', contact: '09293456789', email: 'francisco.morales@email.com', center: 'iloilo', tuition: 11500, enrollmentDate: '2024-02-10', status: 'active' },
                { id: 14, firstName: 'Sebastian', lastName: 'Castro', age: 7, gender: 'Male', parent: 'Gabriela Castro', contact: '09304567890', email: 'gabriela.castro@email.com', center: 'qc-vertis', tuition: 15500, enrollmentDate: '2024-01-12', status: 'active' },
                { id: 15, firstName: 'Emma', lastName: 'Jimenez', age: 4, gender: 'Female', parent: 'Antonio Jimenez', contact: '09315678901', email: 'antonio.jimenez@email.com', center: 'mandaluyong', tuition: 14500, enrollmentDate: '2024-02-20', status: 'active' },
                { id: 16, firstName: 'Mateo', lastName: 'Rivera', age: 6, gender: 'Male', parent: 'Patricia Rivera', contact: '09326789012', email: 'patricia.rivera@email.com', center: 'cebu', tuition: 13000, enrollmentDate: '2024-01-28', status: 'active' },
                { id: 17, firstName: 'Victoria', lastName: 'Hernandez', age: 5, gender: 'Female', parent: 'Manuel Hernandez', contact: '09337890123', email: 'manuel.hernandez@email.com', center: 'paranaque', tuition: 13500, enrollmentDate: '2024-02-03', status: 'active' },
                { id: 18, firstName: 'Lucas', lastName: 'Salazar', age: 4, gender: 'Male', parent: 'Sofia Salazar', contact: '09348901234', email: 'sofia.salazar@email.com', center: 'taguig', tuition: 14000, enrollmentDate: '2024-01-17', status: 'active' },
                { id: 19, firstName: 'Mia', lastName: 'Perez', age: 6, gender: 'Female', parent: 'Jorge Perez', contact: '09359012345', email: 'jorge.perez@email.com', center: 'cagayan', tuition: 12500, enrollmentDate: '2024-02-18', status: 'active' },
                { id: 20, firstName: 'Nicolas', lastName: 'Gonzalez', age: 5, gender: 'Male', parent: 'Diana Gonzalez', contact: '09360123456', email: 'diana.gonzalez@email.com', center: 'davao', tuition: 13500, enrollmentDate: '2024-01-08', status: 'active' },
                { id: 21, firstName: 'Olivia', lastName: 'Lopez', age: 3, gender: 'Female', parent: 'Ricardo Lopez', contact: '09371234567', email: 'ricardo.lopez@email.com', center: 'makati-legaspi', tuition: 16000, enrollmentDate: '2024-02-25', status: 'active' },
                { id: 22, firstName: 'Andres', lastName: 'Martin', age: 7, gender: 'Male', parent: 'Laura Martin', contact: '09382345678', email: 'laura.martin@email.com', center: 'ortigas', tuition: 14000, enrollmentDate: '2024-01-05', status: 'active' },
                { id: 23, firstName: 'Catalina', lastName: 'Ramirez', age: 4, gender: 'Female', parent: 'Javier Ramirez', contact: '09393456789', email: 'javier.ramirez@email.com', center: 'alabang', tuition: 15000, enrollmentDate: '2024-02-14', status: 'active' },
                { id: 24, firstName: 'Leonardo', lastName: 'Navarro', age: 6, gender: 'Male', parent: 'Monica Navarro', contact: '09404567890', email: 'monica.navarro@email.com', center: 'pasig', tuition: 14000, enrollmentDate: '2024-01-11', status: 'active' },
                { id: 25, firstName: 'Amanda', lastName: 'Gutierrez', age: 5, gender: 'Female', parent: 'Oscar Gutierrez', contact: '09415678901', email: 'oscar.gutierrez@email.com', center: 'bgc', tuition: 18000, enrollmentDate: '2024-02-22', status: 'active' }
            ],
            billing: [
                { id: 1, studentId: 1, type: 'tuition', amount: 15000, date: '2024-01-15', monthFor: '2024-02', status: 'paid' },
                { id: 2, studentId: 2, type: 'tuition', amount: 16000, date: '2024-01-20', monthFor: '2024-02', status: 'paid' },
                { id: 3, studentId: 3, type: 'tuition', amount: 18000, date: '2024-02-01', monthFor: '2024-02', status: 'paid' },
                { id: 4, studentId: 5, type: 'tuition', amount: 13000, date: '2024-01-10', monthFor: '2024-02', status: 'paid' },
                { id: 5, studentId: 7, type: 'miscellaneous', amount: 2500, date: '2024-02-12', monthFor: '2024-02', status: 'paid' },
                { id: 6, studentId: 10, type: 'tuition', amount: 6000, date: '2024-01-22', monthFor: '2024-02', status: 'partial' },
                { id: 7, studentId: 15, type: 'tuition', amount: 14500, date: '2024-02-20', monthFor: '2024-02', status: 'paid' },
                { id: 8, studentId: 20, type: 'tuition', amount: 13500, date: '2024-01-08', monthFor: '2024-02', status: 'paid' },
                { id: 9, studentId: 1, type: 'tuition', amount: 15000, date: '2024-02-15', monthFor: '2024-03', status: 'paid' },
                { id: 10, studentId: 3, type: 'tuition', amount: 18000, date: '2024-03-01', monthFor: '2024-03', status: 'paid' },
                { id: 11, studentId: 12, type: 'tuition', amount: 18000, date: '2024-01-30', monthFor: '2024-02', status: 'paid' },
                { id: 12, studentId: 16, type: 'tuition', amount: 13000, date: '2024-01-28', monthFor: '2024-02', status: 'paid' },
                { id: 13, studentId: 25, type: 'tuition', amount: 18000, date: '2024-02-22', monthFor: '2024-03', status: 'paid' }
            ],
            settings: {
                capacityWarningThreshold: 70,
                arWarningThreshold: 10
            }
        };

        let currentPage = 'dashboard';
        let selectedCenter = 'all';
        let editingStudentId = null;

        function init() {
            const centerSelect = document.getElementById('centerSelect');
            CCLDI_DATABASE.centers.forEach(center => {
                const option = document.createElement('option');
                option.value = center.id;
                option.textContent = center.name;
                centerSelect.appendChild(option);
            });

            const studentCenterSelect = document.getElementById('studentCenter');
            CCLDI_DATABASE.centers.forEach(center => {
                const option = document.createElement('option');
                option.value = center.id;
                option.textContent = center.name;
                studentCenterSelect.appendChild(option);
            });

            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');
                    currentPage = item.getAttribute('data-page');
                    renderPage();
                });
            });

            document.getElementById('centerSelect').addEventListener('change', (e) => {
                selectedCenter = e.target.value;
                renderPage();
            });

            const today = new Date().toISOString().split('T')[0];
            document.getElementById('billingDate').value = today;

            renderPage();
        }

        function renderPage() {
            const contentArea = document.getElementById('contentArea');
            switch(currentPage) {
                case 'dashboard':
                    contentArea.innerHTML = renderDashboard();
                    break;
                case 'students':
                    contentArea.innerHTML = renderStudents();
                    break;
                case 'billing':
                    contentArea.innerHTML = renderBilling();
                    break;
                case 'settings':
                    contentArea.innerHTML = renderSettings();
                    break;
            }
        }

        function renderDashboard() {
            const stats = calculateGlobalStats();
            const centerStats = calculateCenterStats();

            let centerCardsHTML = '';
            centerStats.forEach(center => {
                const isWarning = center.capacityPercent < CCLDI_DATABASE.settings.capacityWarningThreshold ||
                                 center.arPercent > CCLDI_DATABASE.settings.arWarningThreshold;

                centerCardsHTML += `
                    <div class="center-card ${isWarning ? 'warning' : ''}">
                        <div class="center-name">${center.name}</div>
                        <div class="center-stat">
                            <span class="center-stat-label">Enrollment:</span>
                            <span class="center-stat-value">${center.enrollment} / ${center.capacity}</span>
                        </div>
                        <div class="center-stat">
                            <span class="center-stat-label">Capacity:</span>
                            <span class="center-stat-value ${center.capacityPercent < CCLDI_DATABASE.settings.capacityWarningThreshold ? 'warning' : ''}">${center.capacityPercent.toFixed(1)}%</span>
                        </div>
                        <div class="center-stat">
                            <span class="center-stat-label">AR Outstanding:</span>
                            <span class="center-stat-value ${center.arPercent > CCLDI_DATABASE.settings.arWarningThreshold ? 'warning' : ''}">PHP ${formatMoney(center.arOutstanding)}</span>
                        </div>
                        <div class="center-stat">
                            <span class="center-stat-label">AR Rate:</span>
                            <span class="center-stat-value ${center.arPercent > CCLDI_DATABASE.settings.arWarningThreshold ? 'warning' : ''}">${center.arPercent.toFixed(1)}%</span>
                        </div>
                    </div>
                `;
            });

            const capacityWarning = stats.capacityPercent < CCLDI_DATABASE.settings.capacityWarningThreshold;
            const arWarning = stats.arPercent > CCLDI_DATABASE.settings.arWarningThreshold;

            return `
                <h1 class="page-title">Ecosystem Dashboard</h1>

                ${capacityWarning || arWarning ? `
                    <div class="info-banner warning">
                        <strong>Pre-Mortem Alerts:</strong>
                        ${capacityWarning ? `System capacity at ${stats.capacityPercent.toFixed(1)}% (below ${CCLDI_DATABASE.settings.capacityWarningThreshold}% threshold). ` : ''}
                        ${arWarning ? `AR rate at ${stats.arPercent.toFixed(1)}% (above ${CCLDI_DATABASE.settings.arWarningThreshold}% threshold).` : ''}
                    </div>
                ` : ''}

                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-label">Total Enrollment</div>
                        <div class="kpi-value">${stats.totalEnrollment}</div>
                        <div class="kpi-subtitle">Active Students</div>
                    </div>
                    <div class="kpi-card ${capacityWarning ? 'warning' : ''}">
                        <div class="kpi-label">System Capacity</div>
                        <div class="kpi-value">${stats.capacityPercent.toFixed(1)}%</div>
                        <div class="kpi-subtitle">${stats.totalEnrollment} / ${stats.totalCapacity} Slots</div>
                    </div>
                    <div class="kpi-card ${arWarning ? 'warning' : ''}">
                        <div class="kpi-label">Accounts Receivable</div>
                        <div class="kpi-value">PHP ${formatMoney(stats.totalAR)}</div>
                        <div class="kpi-subtitle">${stats.arPercent.toFixed(1)}% of Expected Revenue</div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-label">Monthly Revenue</div>
                        <div class="kpi-value">PHP ${formatMoney(stats.monthlyRevenue)}</div>
                        <div class="kpi-subtitle">Expected from Tuition</div>
                    </div>
                </div>

                <hr class="section-divider">

                <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 16px;">Center Performance Overview</h2>
                <div class="center-overview-grid">
                    ${centerCardsHTML}
                </div>
            `;
        }

        function renderStudents() {
            let students = CCLDI_DATABASE.students.filter(s => s.status === 'active');
            if (selectedCenter !== 'all') {
                students = students.filter(s => s.center === selectedCenter);
            }

            let studentsHTML = '';
            students.forEach(student => {
                const center = CCLDI_DATABASE.centers.find(c => c.id === student.center);
                const arInfo = calculateStudentAR(student.id);

                studentsHTML += `
                    <tr>
                        <td>${student.firstName} ${student.lastName}</td>
                        <td>${student.age}</td>
                        <td>${student.parent}</td>
                        <td>${student.contact}</td>
                        <td>${center ? center.name : 'N/A'}</td>
                        <td class="amount">PHP ${formatMoney(student.tuition)}</td>
                        <td>
                            ${arInfo.outstanding > 0 ? `<span class="badge warning">PHP ${formatMoney(arInfo.outstanding)}</span>` : `<span class="badge success">Paid</span>`}
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn" onclick="editStudent(${student.id})">Edit</button>
                                <button class="action-btn delete" onclick="deleteStudent(${student.id})">Delete</button>
                            </div>
                        </td>
                    </tr>
                `;
            });

            return `
                <h1 class="page-title">Student Ledger</h1>

                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">Active Students (${students.length})</div>
                        <div class="table-actions">
                            <input type="text" class="search-box" placeholder="Search students..." id="studentSearch" onkeyup="filterStudents()">
                            <button class="btn btn-small" onclick="openStudentModal()">Add Student</button>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Age</th>
                                <th>Parent/Guardian</th>
                                <th>Contact</th>
                                <th>Center</th>
                                <th>Monthly Tuition</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="studentsTableBody">
                            ${studentsHTML || '<tr><td colspan="8"><div class="empty-state"><div class="empty-state-icon">ðŸ“‹</div><div class="empty-state-text">No students found</div></div></td></tr>'}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function renderBilling() {
            const agingReport = generateAgingReport();
            const totalOutstanding = agingReport.reduce((sum, item) => sum + item.totalOutstanding, 0);
            const totalCurrent = agingReport.reduce((sum, item) => sum + item.current, 0);
            const total30 = agingReport.reduce((sum, item) => sum + item.days30, 0);
            const total60 = agingReport.reduce((sum, item) => sum + item.days60, 0);
            const total90 = agingReport.reduce((sum, item) => sum + item.days90Plus, 0);

            let agingHTML = '';
            agingReport.forEach(item => {
                const isWarning = item.totalOutstanding > 0;
                agingHTML += `
                    <div class="aging-row ${isWarning ? 'warning' : ''}">
                        <div>
                            <strong>${item.studentName}</strong><br>
                            <span style="font-size: 12px; color: #666;">${item.centerName}</span>
                        </div>
                        <div class="amount">PHP ${formatMoney(item.totalOutstanding)}</div>
                        <div class="amount">PHP ${formatMoney(item.current)}</div>
                        <div class="amount">PHP ${formatMoney(item.days30)}</div>
                        <div class="amount">PHP ${formatMoney(item.days60)}</div>
                        <div class="amount">PHP ${formatMoney(item.days90Plus)}</div>
                    </div>
                `;
            });

            return `
                <h1 class="page-title">Financial Dashboard</h1>

                <div style="display: flex; gap: 16px; margin-bottom: 24px;">
                    <button class="btn" onclick="openBillingModal()">Record Payment</button>
                    <button class="btn btn-secondary" onclick="renderPage()">Refresh Report</button>
                </div>

                <div class="info-banner">
                    <strong>Value-Investing Principle:</strong> Outstanding AR represents capital locked in operations. Focus on collection efficiency to optimize cash flow and reinvestment capacity.
                </div>

                <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 12px;">Aging Report</h2>
                <p style="font-size: 14px; color: #666; margin-bottom: 16px;">Outstanding balances as of ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>

                <div class="aging-report">
                    <div class="aging-header">
                        <div>Student / Center</div>
                        <div>Total Outstanding</div>
                        <div>Current</div>
                        <div>1-30 Days</div>
                        <div>31-60 Days</div>
                        <div>60+ Days</div>
                    </div>
                    ${agingHTML || '<div style="padding: 40px; text-align: center; color: #999;">No outstanding balances</div>'}
                </div>

                ${agingHTML ? `
                    <div class="stats-row">
                        <span>Total Outstanding:</span>
                        <span class="amount">PHP ${formatMoney(totalOutstanding)}</span>
                    </div>
                ` : ''}
            `;
        }

        function renderSettings() {
            return `
                <h1 class="page-title">System Settings</h1>

                <div class="settings-section">
                    <div class="settings-title">Pre-Mortem Warning Thresholds</div>
                    <div class="settings-item">
                        <div>
                            <div class="settings-label">Capacity Warning Threshold</div>
                            <div class="settings-description">Alert when center capacity falls below this percentage</div>
                        </div>
                        <input type="number" value="${CCLDI_DATABASE.settings.capacityWarningThreshold}" min="0" max="100"
                               style="width: 80px; padding: 8px; border: 1px solid #E0E0E0; text-align: center;"
                               onchange="updateSetting('capacityWarningThreshold', this.value)">
                    </div>
                    <div class="settings-item">
                        <div>
                            <div class="settings-label">AR Warning Threshold</div>
                            <div class="settings-description">Alert when AR rate exceeds this percentage</div>
                        </div>
                        <input type="number" value="${CCLDI_DATABASE.settings.arWarningThreshold}" min="0" max="100"
                               style="width: 80px; padding: 8px; border: 1px solid #E0E0E0; text-align: center;"
                               onchange="updateSetting('arWarningThreshold', this.value)">
                    </div>
                </div>

                <div class="settings-section">
                    <div class="settings-title">System Information</div>
                    <div class="settings-item">
                        <div>
                            <div class="settings-label">Total Centers</div>
                            <div class="settings-description">11 Corporate + 5 Franchise locations</div>
                        </div>
                        <span style="font-weight: 700;">16</span>
                    </div>
                    <div class="settings-item">
                        <div>
                            <div class="settings-label">System Capacity</div>
                            <div class="settings-description">Total student slots across all centers</div>
                        </div>
                        <span style="font-weight: 700;">${CCLDI_DATABASE.centers.reduce((sum, c) => sum + c.capacity, 0)}</span>
                    </div>
                    <div class="settings-item">
                        <div>
                            <div class="settings-label">Active Students</div>
                            <div class="settings-description">Currently enrolled across all locations</div>
                        </div>
                        <span style="font-weight: 700;">${CCLDI_DATABASE.students.filter(s => s.status === 'active').length}</span>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="settings-title">About CSMS</div>
                    <div style="font-size: 14px; line-height: 1.6; color: #666;">
                        <p style="margin-bottom: 12px;"><strong>CCLDI Student Management System (CSMS)</strong></p>
                        <p style="margin-bottom: 8px;">Built on first principles for high-velocity oversight of 16-location ecosystem.</p>
                        <p style="margin-bottom: 8px;">Version: 1.0.0 | Single-File Production Prototype</p>
                        <p>Design Philosophy: Ultra-minimalist. Operational clarity over aesthetic complexity.</p>
                    </div>
                </div>
            `;
        }

        function calculateGlobalStats() {
            const activeStudents = CCLDI_DATABASE.students.filter(s => s.status === 'active');
            const totalCapacity = CCLDI_DATABASE.centers.reduce((sum, c) => sum + c.capacity, 0);
            const totalEnrollment = activeStudents.length;
            const capacityPercent = (totalEnrollment / totalCapacity) * 100;

            const monthlyRevenue = activeStudents.reduce((sum, s) => sum + s.tuition, 0);
            const totalPaid = CCLDI_DATABASE.billing.reduce((sum, b) => sum + b.amount, 0);

            const currentMonth = new Date().toISOString().slice(0, 7);
            const expectedRevenue = monthlyRevenue * 3;
            const totalAR = expectedRevenue - totalPaid;
            const arPercent = (totalAR / expectedRevenue) * 100;

            return {
                totalEnrollment,
                totalCapacity,
                capacityPercent,
                monthlyRevenue,
                totalAR: totalAR > 0 ? totalAR : 0,
                arPercent: arPercent > 0 ? arPercent : 0
            };
        }

        function calculateCenterStats() {
            return CCLDI_DATABASE.centers.map(center => {
                const students = CCLDI_DATABASE.students.filter(s => s.center === center.id && s.status === 'active');
                const enrollment = students.length;
                const capacityPercent = (enrollment / center.capacity) * 100;

                let arOutstanding = 0;
                let expectedRevenue = 0;
                students.forEach(student => {
                    const studentAR = calculateStudentAR(student.id);
                    arOutstanding += studentAR.outstanding;
                    expectedRevenue += student.tuition * 3;
                });

                const arPercent = expectedRevenue > 0 ? (arOutstanding / expectedRevenue) * 100 : 0;

                return {
                    id: center.id,
                    name: center.name,
                    enrollment,
                    capacity: center.capacity,
                    capacityPercent,
                    arOutstanding,
                    arPercent
                };
            }).sort((a, b) => b.enrollment - a.enrollment);
        }

        function calculateStudentAR(studentId) {
            const student = CCLDI_DATABASE.students.find(s => s.id === studentId);
            if (!student) return { outstanding: 0, monthsUnpaid: 0 };

            const enrollmentDate = new Date(student.enrollmentDate);
            const currentDate = new Date();

            const monthsSinceEnrollment = Math.floor((currentDate - enrollmentDate) / (1000 * 60 * 60 * 24 * 30));
            const expectedPayments = monthsSinceEnrollment + 1;
            const expectedTotal = student.tuition * expectedPayments;

            const payments = CCLDI_DATABASE.billing.filter(b => b.studentId === studentId);
            const totalPaid = payments.reduce((sum, p) => sum + p.amount, 0);

            const outstanding = Math.max(0, expectedTotal - totalPaid);
            const monthsUnpaid = Math.floor(outstanding / student.tuition);

            return { outstanding, monthsUnpaid };
        }

        function generateAgingReport() {
            const report = [];
            const activeStudents = CCLDI_DATABASE.students.filter(s => s.status === 'active');

            activeStudents.forEach(student => {
                const arInfo = calculateStudentAR(student.id);
                if (arInfo.outstanding > 0) {
                    const center = CCLDI_DATABASE.centers.find(c => c.id === student.center);

                    let current = 0, days30 = 0, days60 = 0, days90Plus = 0;

                    if (arInfo.monthsUnpaid === 0) {
                        current = arInfo.outstanding;
                    } else if (arInfo.monthsUnpaid === 1) {
                        days30 = arInfo.outstanding;
                    } else if (arInfo.monthsUnpaid === 2) {
                        days60 = arInfo.outstanding;
                    } else {
                        days90Plus = arInfo.outstanding;
                    }

                    report.push({
                        studentId: student.id,
                        studentName: `${student.firstName} ${student.lastName}`,
                        centerName: center ? center.name : 'Unknown',
                        totalOutstanding: arInfo.outstanding,
                        current,
                        days30,
                        days60,
                        days90Plus
                    });
                }
            });

            return report.sort((a, b) => b.totalOutstanding - a.totalOutstanding);
        }

        function openStudentModal() {
            editingStudentId = null;
            document.getElementById('studentModalTitle').textContent = 'Add Student';
            document.getElementById('studentForm').reset();
            document.getElementById('studentId').value = '';
            document.getElementById('studentModal').classList.add('active');
        }

        function closeStudentModal() {
            document.getElementById('studentModal').classList.remove('active');
            editingStudentId = null;
        }

        function editStudent(studentId) {
            const student = CCLDI_DATABASE.students.find(s => s.id === studentId);
            if (!student) return;

            editingStudentId = studentId;
            document.getElementById('studentModalTitle').textContent = 'Edit Student';
            document.getElementById('studentId').value = student.id;
            document.getElementById('studentFirstName').value = student.firstName;
            document.getElementById('studentLastName').value = student.lastName;
            document.getElementById('studentAge').value = student.age;
            document.getElementById('studentGender').value = student.gender;
            document.getElementById('studentParent').value = student.parent;
            document.getElementById('studentContact').value = student.contact;
            document.getElementById('studentEmail').value = student.email || '';
            document.getElementById('studentCenter').value = student.center;
            document.getElementById('studentTuition').value = student.tuition;
            document.getElementById('studentModal').classList.add('active');
        }

        function saveStudent() {
            const form = document.getElementById('studentForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const studentData = {
                firstName: document.getElementById('studentFirstName').value,
                lastName: document.getElementById('studentLastName').value,
                age: parseInt(document.getElementById('studentAge').value),
                gender: document.getElementById('studentGender').value,
                parent: document.getElementById('studentParent').value,
                contact: document.getElementById('studentContact').value,
                email: document.getElementById('studentEmail').value,
                center: document.getElementById('studentCenter').value,
                tuition: parseFloat(document.getElementById('studentTuition').value),
                status: 'active'
            };

            if (editingStudentId) {
                const student = CCLDI_DATABASE.students.find(s => s.id === editingStudentId);
                Object.assign(student, studentData);
            } else {
                const newId = Math.max(...CCLDI_DATABASE.students.map(s => s.id)) + 1;
                CCLDI_DATABASE.students.push({
                    id: newId,
                    ...studentData,
                    enrollmentDate: new Date().toISOString().split('T')[0]
                });
            }

            closeStudentModal();
            renderPage();
        }

        function deleteStudent(studentId) {
            if (!confirm('Are you sure you want to delete this student? This action cannot be undone.')) {
                return;
            }

            const student = CCLDI_DATABASE.students.find(s => s.id === studentId);
            if (student) {
                student.status = 'inactive';
            }

            renderPage();
        }

        function openBillingModal() {
            document.getElementById('billingForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('billingDate').value = today;

            const billingStudentSelect = document.getElementById('billingStudent');
            billingStudentSelect.innerHTML = '<option value="">Select Student</option>';

            const activeStudents = CCLDI_DATABASE.students.filter(s => s.status === 'active');
            activeStudents.forEach(student => {
                const option = document.createElement('option');
                option.value = student.id;
                option.textContent = `${student.firstName} ${student.lastName}`;
                billingStudentSelect.appendChild(option);
            });

            document.getElementById('billingModal').classList.add('active');
        }

        function closeBillingModal() {
            document.getElementById('billingModal').classList.remove('active');
        }

        function recordPayment() {
            const form = document.getElementById('billingForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const studentId = parseInt(document.getElementById('billingStudent').value);
            const type = document.getElementById('billingType').value;
            const amount = parseFloat(document.getElementById('billingAmount').value);
            const date = document.getElementById('billingDate').value;
            const notes = document.getElementById('billingNotes').value;

            const newId = Math.max(...CCLDI_DATABASE.billing.map(b => b.id), 0) + 1;

            CCLDI_DATABASE.billing.push({
                id: newId,
                studentId,
                type,
                amount,
                date,
                monthFor: date.slice(0, 7),
                status: 'paid',
                notes: notes || undefined
            });

            closeBillingModal();
            renderPage();
        }

        function filterStudents() {
            const searchTerm = document.getElementById('studentSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#studentsTableBody tr');

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function updateSetting(key, value) {
            CCLDI_DATABASE.settings[key] = parseFloat(value);
            renderPage();
        }

        function formatMoney(amount) {
            return amount.toLocaleString('en-PH', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
